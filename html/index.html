<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NFT Cards</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="../css/shared_navbar.css">
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
    <!-- ================== NAVBAR ================== -->
    <nav class="navbar">
        <div class="container-fluid">
            <div class="nav-group">
                <a href="index.html" class="logo-brand">
                    <img src="../assets/Logo.png" alt="Logo" width="40">
                    <span>NFT Brand</span>
                </a>
                <div class="nav-links">
                    <a href="create.html">Create</a>
                    <a href="#">Explore</a>
                    <a href="account.html">Sell</a>
                    <a href="#">Marketplaces</a>
                    <a href="#">Airdrop</a>
                </div>
            </div>
            <div class="navbar-right">
                <div class="search-box">
                    <input type="text" placeholder="Search for NFTS, collections, users." class="form-control">
                    <i class="bi bi-search"></i>
                </div>
                <!-- Thay thế phần wallet cũ bằng cấu trúc mới -->
                <div id="walletSection">
                    <button id="connectWalletBtn" class="btn btn-outline-success connect-btn" type="button"
                        onclick="window.location.href='../html/login.html';">
                        Connect wallet
                    </button>

                    <div id="walletInfo" class="dropdown" style="display: none;">
                        <div class="wallet-dropdown" data-bs-toggle="dropdown">
                            <img src="../assets/user.png" alt="Wallet Avatar" class="wallet-avatar">
                            <span id="navbarUsername">0x0000...0000</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="../html/account.html">
                                <i class="fas fa-user"></i>
                                Profile
                            </a>
                            <a class="dropdown-item" href="#">
                                <i class="fas fa-question-circle"></i>
                                Help Center & Documentation
                            </a>
                            <div class="dropdown-divider"></div>
                            <div class="network-item">
                                Network
                                <span>Forma</span>
                            </div>
                            <div class="theme-item">
                                Theme
                                <div class="theme-options">
                                    <button class="theme-btn active">Light</button>
                                    <button class="theme-btn">Dark</button>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#" onclick="disconnectWallet()">
                                <i class="fas fa-sign-out-alt"></i>
                                Sign Out
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ================== CAROUSEL ================== -->
    <div id="carouselExampleIndicators" class="carousel slide carousel-fade" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="../assets/1.jpg" class="d-block w-100" alt="Slide 1" />
            </div>
            <div class="carousel-item">
                <img src="../assets/2.jpg" class="d-block w-100" alt="Slide 2" />
            </div>
            <div class="carousel-item">
                <img src="../assets/3.jpg" class="d-block w-100" alt="Slide 3" />
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <!-- ================== NFT CARDS SECTION ================== -->
    <main class="cards-section my-5">
        <!-- row-cols responsive: row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 -->
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4">
            <!-- Card 1 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/1.jpg" alt="NFT 1" />
                    <div class="p-3">
                        <!-- Tên tác giả + biểu tượng xác thực (nếu có) -->
                        <div class="author-info mb-1">
                            <span>User 1</span>
                            <span class="verified">●</span>
                        </div>
                        <!-- Tiêu đề NFT -->
                        <div class="nft-title">Beautiful NFT 1</div>
                        <!-- Thông tin meta -->
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.04 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 2 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/2.jpg" alt="NFT 2" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 2</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 2</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Pre-ordered</span>
                            <span class="nft-price">0.001 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 3 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/3.jpg" alt="NFT 3" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 3</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 3</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Pre-ordered</span>
                            <span class="nft-price">0.00123 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 4 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/1.jpg" alt="NFT 4" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 4</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 4</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.01 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 5 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/3.jpg" alt="NFT 5" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 5</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 5</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.0015 ETH</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /row -->

        <!-- Thêm 1 dòng nữa (nếu muốn nhiều NFT hơn) -->
        <br />
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4">
            <!-- Lặp lại các card hoặc thay nội dung mới -->
            <!-- Card 6 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/1.jpg" alt="NFT 1" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 1</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 1</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.04 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 7 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/2.jpg" alt="NFT 2" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 2</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 2</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Pre-ordered</span>
                            <span class="nft-price">0.001 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 8 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/3.jpg" alt="NFT 3" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 3</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 3</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Pre-ordered</span>
                            <span class="nft-price">0.00123 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 9 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/1.jpg" alt="NFT 4" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 4</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 4</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.01 ETH</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 10 -->
            <div class="col">
                <div class="nft-card">
                    <img src="../assets/3.jpg" alt="NFT 5" />
                    <div class="p-3">
                        <div class="author-info mb-1">
                            <span>User 5</span>
                            <span class="verified">●</span>
                        </div>
                        <div class="nft-title">Beautiful NFT 5</div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Status</span>
                            <span>Price</span>
                        </div>
                        <div class="d-flex justify-content-between nft-meta">
                            <span class="label">Now</span>
                            <span class="nft-price">0.0015 ETH</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /row -->
    </main>

    <!-- ================== FOOTER ================== -->
    <footer class="py-5" style="background-color: #f9f9f9; color: #333;">
        <!-- Sử dụng .container thay vì .container-fluid để footer hẹp hơn, cân đối hơn -->
        <div class="container">
            <div class="row align-items-start">
                <!-- Cột Trái: Stay in the loop -->
                <div class="col-md-4 text-start mb-4 mb-md-0">
                    <h5 style="font-weight: 600;">Stay in the loop</h5>
                    <p style="color: #555; font-size: 0.95rem;">
                        Join our mailing list to stay in the loop with our newest features.
                    </p>

                    <!-- Form ô email + nút Sign up, nhỏ gọn để tránh xuống dòng -->
                    <div class="d-flex flex-nowrap" style="max-width: 280px;">
                        <input class="form-control me-2" type="email" placeholder="Your email address"
                            style="width: 150px; border-radius: 5px; background-color: #f1f1f1; border: none; color: #333;" />
                        <button class="btn btn-primary" style="white-space: nowrap; border-radius: 5px;">
                            Sign up
                        </button>
                    </div>
                </div>

                <!-- Cột Giữa: Join the community -->
                <div class="col-md-4 text-center mb-4 mb-md-0">
                    <h5 style="font-weight: 600;">Join the community</h5>
                    <div class="mt-3 d-flex justify-content-center gap-3">
                        <!-- Thay đường dẫn icon thật của bạn -->
                        <a href="#">
                            <img src="../assets/zalo.svg" alt="Zalo" style="width: 32px; height: 32px;" />
                        </a>
                        <a href="#">
                            <img src="../assets/discord.svg" alt="Discord" style="width: 32px; height: 32px;" />
                        </a>
                        <a href="#">
                            <img src="../assets/telegram.svg" alt="Telegram" style="width: 32px; height: 32px;" />
                        </a>
                        <a href="#">
                            <img src="../assets/email.svg" alt="Email" style="width: 32px; height: 32px;" />
                        </a>
                    </div>
                </div>

                <!-- Cột Phải: Need help? -->
                <div class="col-md-4 text-end">
                    <h5 style="font-weight: 600;">Need help?</h5>
                    <p style="color: #555; font-size: 0.95rem;">
                        Have questions or need assistance? Our support team is here for you.
                    </p>
                    <button class="btn btn-primary" style="border-radius: 5px; white-space: nowrap;">
                        Contact Support
                    </button>
                </div>
            </div>

            <!-- Dòng bản quyền phía dưới -->
            <div class="text-center pt-4 mt-4" style="border-top: 1px solid #eaeaea;">
                <small class="text-muted">
                    &copy; 2025 Your Company. All rights reserved.
                </small>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="scripts/web3.min.js"></script>
    <script src="scripts/init.js"></script>
    <script src="../scripts/profile_manager.js"></script>
    <script src="../scripts/wallet_manager.js"></script>
    <!-- Thêm script xử lý wallet trước thẻ đóng body -->
    <script>
        window.onload = function () {
            checkWalletConnection();
        }

        function checkWalletConnection() {
            const savedAddress = localStorage.getItem('walletAddress');
            const userProfile = localStorage.getItem('userProfile');

            if (savedAddress) {
                const shortAddress = `${savedAddress.substring(0, 6)}...${savedAddress.substring(savedAddress.length - 4)}`;

                // Ẩn nút connect và hiển thị wallet info
                document.getElementById('connectWalletBtn').style.display = 'none';
                document.getElementById('walletInfo').style.display = 'block';

                // Kiểm tra và hiển thị username hoặc address
                if (userProfile) {
                    const profile = JSON.parse(userProfile);
                    const navbarUsername = document.getElementById('navbarUsername');
                    const walletAvatar = document.querySelector('.wallet-avatar');

                    if (navbarUsername) {
                        navbarUsername.textContent = profile.name?.trim() || shortAddress;
                    }
                    if (walletAvatar && profile.profilePicture) {
                        walletAvatar.src = profile.profilePicture;
                    }
                } else {
                    // Nếu chưa có profile, hiển thị short address
                    const navbarUsername = document.getElementById('navbarUsername');
                    if (navbarUsername) {
                        navbarUsername.textContent = shortAddress;
                    }
                }
            } else {
                showConnectButton();
            }
        }

        function showConnectButton() {
            document.getElementById('connectWalletBtn').style.display = 'block';
            document.getElementById('walletInfo').style.display = 'none';
        }

        function disconnectWallet() {
            localStorage.removeItem('walletAddress');
            showConnectButton();
            console.log('Wallet disconnected');
        }

        // Khi connect lại, chỉ cần kiểm tra và sử dụng profile cũ nếu có
        async function connectWallet() {
            try {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const account = accounts[0];
                localStorage.setItem('walletAddress', account);

                // Kiểm tra xem có profile cũ không
                const existingProfile = localStorage.getItem('userProfile');
                if (!existingProfile) {
                    // Nếu chưa có profile, tạo profile mới với địa chỉ ví
                    const shortAddress = `${account.substring(0, 6)}...${account.substring(account.length - 4)}`;
                    const newProfile = {
                        name: shortAddress,
                        bio: '',
                        profilePicture: null
                    };
                    localStorage.setItem('userProfile', JSON.stringify(newProfile));
                }

                checkWalletConnection();
                console.log('Wallet connected:', account);
            } catch (error) {
                console.error('Error connecting wallet:', error);
            }
        }

        // Lắng nghe sự kiện thay đổi tài khoản từ MetaMask
        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', function (accounts) {
                if (accounts.length === 0) {
                    disconnectWallet();
                } else {
                    localStorage.setItem('walletAddress', accounts[0]);
                    checkWalletConnection();
                }
            });
        }
    </script>

</body>

</html>